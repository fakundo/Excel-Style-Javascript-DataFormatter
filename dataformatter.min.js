DataFormatter={functions:{},locale:{months:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],months_short:["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],days:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],days_short:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],thousands_separator:" ",decimal_separator:",",formats:{General:"@","General Number":"#.#",Currency:"#,##0.00р.;[Red]-#,##0.00р.",Fixed:"0.00",Standard:"#,##0.00",Percent:"0.00%",Scientific:"0.00E+00","Yes/No":'"Да";"Да";"Нет"',"True/False":'"Истина";"Истина";"Ложь"',"On/Off":'"Вкл";"Вкл";"Выкл"',"Short Date":"mm.dd.yyyy","Long Date":"dd mmmm yyyy","General Date":"mm.dd.yyyy h:mm","Medium Date":"dd.mmm.yy","Long Time":"hh:mm:ss AM/PM","Short Time":"h:mm","Medium Time":"hh:mm AM/PM"}},fillNumberPattern:function(h,g,c){h=h.toString();var e="",d,b;if(c=="right"){b=0;for(d=0;d<g.length;d++){switch(g[d]){case"0":e+=h[b]?h[b]:"0";b++;break;case"#":e+=h[b]?h[b]:"";b++;break;case"?":e+=h[b]?h[b]:" ";b++;break;case"[":while(d<g.length&&g[d]!="]"){e+=g[d];d++}d--;break;default:e+=g[d]}}}else{var f,a;g=g.replace(/(0|#|\?)(,+?)(0|#|\?)/g,function(j,l,k,i){a=true;return l+i});if(a){for(b=h.length-3;h[0]=="-"?b>1:b>0;b-=3){h=h.substr(0,b)+DataFormatter.locale.thousands_separator+h.substr(b)}}b=h.length-1;for(d=g.length-1;d>=0;d--){switch(g[d]){case"0":e=(h[b]?h[b]:"0")+e;f=d;b--;break;case"#":e=(h[b]?h[b]:"")+e;f=d;b--;break;case"?":e=(h[b]?h[b]:" ")+e;f=d;b--;break;case"]":while(d>0&&g[d]!="["){e=g[d]+e;d--}d++;break;default:e=g[d]+e}}if(b>=0&&f!=null){e=e.substr(0,f)+h.substr(0,b+1)+e.substr(f)}}return e},makeReplaces:function(a,b){return a.replace(/\[(?:(\$*)|(.*))]/g,function(c,d){return d&&b[d.length]?b[d.length]:""})},format:function(m,c,r){r=r.toString();if(DataFormatter.functions[r]){return DataFormatter.functions[r](m,c)}var p,t,a="",g,f,q,h,j,e="",o="";j=r;if(DataFormatter.locale.formats[j]){j=DataFormatter.locale.formats[j]}j=j.replace(/"([^"]+)"|\\(.?)|(_.?)|(\*.?)|(")/g,function(i,w,n,d){if(w){o+=',"'+w.replace(/("|'|\\)/g,"\\$1")+'"';return"["+(e+="$")+"]"}if(n){o+=',"'+n.replace(/("|'|\\)/g,"\\$1")+'"';return"["+(e+="$")+"]"}if(d){o+='," "';return"["+(e+="$")+"]"}return""});j=j.split(/;/);t=Math.min(4,j.length);for(p=0;p<t;p++){q="";h=false;q=j[p].match(/\[((?:>|>=|<|<=|=|<>)[0-9\.]+?)]/);if(q){q='type=="Number" && n'+q[1].replace(/<>/,"!=").replace(/=/,"==")}else{if(p==0&&j.length>2){q='type=="Number" && n>0'}else{if(p==0&&j.length>1){q='type=="Number" && n>=0'}else{if(p==1&&j.length>1){q='type=="Number" && n<0';h=true}else{if(p==2&&j.length>3){q='type=="Number"'}}}}}g='var res={value:"'+j[p]+'"}, repl=['+o+"];\n";if(f=j[p].match(/\[(Red|Green|White|Blue|Magenta|Yellow|Cyan|Black)]/i)){g+='res.color="'+f[1]+'";\n'}j[p]=j[p].replace(/(\[((?!((\$*?)|(h*?)|(m*?)|(s*?))]).*?)])/,"");if(j[p].match(/@/)){g+='res.value="'+j[p]+'".replace(/@/,n);\n'}else{if(j[p].match(/#|\?|0/)){var s='n=parseFloat(n);\nres.align="right";\n';if(h){s+="n=Math.abs(n);\n"}if(f=j[p].match(/(.*?)(?:(\.)(.*?))?e(?:\+|\-)(.*)/i)){var v,l;if(!f[1]){f[1]="#";v=10}else{v=Math.pow(10,f[1].match(/0|\?|#/g).length)}if(!f[3]){f[3]="";l=1}else{l=Math.pow(10,f[3].match(/0|\?|#/g).length)}if(!f[4]){f[4]=""}s+="var m=0,sign=n<0?-1:1;\nn=Math.abs(n);\nif(n!=0){\nwhile(n<"+v+" || Math.round(n*"+l+")/"+l+"<"+v+"){\nn*=10;\nm++;\n}\nwhile(n>="+v+" || Math.round(n*"+l+")/"+l+">="+v+"){\nn/=10;\nm--;\n}\n}\nn=(Math.round(n*sign*"+l+")/"+l+').toString().split(".");\nres.value=DataFormatter.fillNumberPattern(parseInt(n[0]),"'+f[1]+'")+';if(f[2]){s+='"'+DataFormatter.locale.decimal_separator+'"+';if(f[3]){s+='DataFormatter.fillNumberPattern(parseInt(n[1]),"'+f[3]+'","right")+'}}s+='"E"+(m>0?"-":"+")+DataFormatter.fillNumberPattern(Math.abs(m),"'+f[4]+'");\n'}else{var k=1;j[p]=j[p].replace(/(0|#|\?)(\s+)([^0?#]*)$/,function(i,w,n,d){k*=Math.pow(1000,n.length);return w+d});if(f=j[p].match(/%/g)){k/=Math.pow(100,f.length)}if(f=j[p].match(/(.*?)\/(.*)/)){if(!f[1]){f[1]="#"}if(!f[2]){f[2]="#"}var u=f[1].length-1;while(f[1][u]=="0"&&f[1][u]!="?"&&f[1][u]!="#"&&f[1][u]!=" "&&u>0){u--}f[3]=f[1].substr(0,u);f[4]=f[1].substr(u);if(!f[3]){s+='var m=n.toString().split("."); m=m[1]?Math.pow(10,m[1].length):1;\nn=Math.floor(n*m);var factor=DataFormatter.gcd(n,m);\nres.value=DataFormatter.fillNumberPattern(n/factor,"'+f[4]+'")+"/"+DataFormatter.fillNumberPattern(m/factor,"'+f[2]+'");\n'}else{s+='var f=0, factor=1, c=1, m=n.toString().split(".");\nif (m[1]) { c=Math.pow(10,m[1].length); f=parseInt(m[1]); factor=DataFormatter.gcd(f,c); }\nres.value=DataFormatter.fillNumberPattern(Math.floor(n),"'+f[3]+'")+DataFormatter.fillNumberPattern(f/factor,"'+f[4]+'")+"/"+DataFormatter.fillNumberPattern(c/factor,"'+f[2]+'");\n'}}else{if(f=j[p].match(/(.*?)\.(.*)/)){if(!f[1]){f[1]="0"}if(!f[2]){f[2]="";l=1}else{l=Math.pow(10,f[2].match(/0|\?|#/g).length)}f[1]=f[1].replace(/(0|#|\?)(\s+)([^0?#]*)$/,function(i,w,n,d){k*=Math.pow(1000,n.length);return w+d});s+="n=(Math.round(n*"+l+")/"+l+').toString().split(".");\nres.value=DataFormatter.fillNumberPattern(parseInt(n[0]),"'+f[1]+'")+"'+DataFormatter.locale.decimal_separator+'"+DataFormatter.fillNumberPattern(parseInt(n[1]||0),"'+f[2]+'","right");\n'}else{s+='res.value=DataFormatter.fillNumberPattern(parseInt(n),"'+j[p]+'");\n'}}if(k!=1){s="n/="+k+";\n"+s}}s="if(isNaN(n) || n>=1e21||n<=-1e21){\nres.value=n;\n}\nelse{\n"+s+"}\n";if(!q){q='type=="Number"'}g+=s}else{if(j[p].match(/d|m|y|h|s/i)){var b=false;j[p]=j[p].replace(/\[(h+?|m+?|s+?|y+?)]/ig,function(d,i){b=true;return i});g+='if(type=="DateTime"){\n';g+="n=new Date(n);\n";g+="if (!isNaN(n.getTime())){\n";if(b){g+='var m, found_hours, found_minutes;\nn=Math.abs(n.getTime()-(new Date("1899-12-31T00:00:00.000")).getTime());\n';j[p]=j[p].replace(/a|p|am|pm|mmm|mmmm|mmmmm|d|y/gi,"");if(j[p].match(/h/i)){g+="found_hours=true;\n"}if(j[p].match(/m/i)){g+="found_minutes=true;\n"}g+='res.value="'+j[p]+'".replace(/(hh)|(h)|(mm)|(m)|(ss)|(s)/gi,function(a,hh,h,mm,m,ss,s){\nif (hh) { return (m=parseInt(n/1000/60/60))<10 ? "0"+m : m; }\nif (h) return parseInt(n/1000/60/60);\nif (mm) { m=found_hours ? parseInt(n/1000/60%60) : parseInt(n/1000/60) ;  return m<10 ? "0"+m : m; }\nif (m) { m=found_hours ? parseInt(n/1000/60%60) : parseInt(n/1000/60) ;  return m; }\nif (ss) { m=found_minutes ? parseInt(n/1000%60) : parseInt(n/1000) ;  return m<10 ? "0"+m : m; }\nif (s) { m=found_minutes ? parseInt(n/1000%60) : parseInt(n/1000) ;  return m; }\nreturn "";\n});\n'}else{g+="var found_ampm;\n";g+='res.value="'+j[p]+'".replace(/((?:am\\/pm)|(?:a\\/p))|(?:(h[^ydsap]*?)mm)|(?:mm([^ydh]*?s))|(?:(h[^ydsap]*?)m)|(?:m([^ydh]*?s))/gi,function(a,ampm,fmin,fmin2,mmin,mmin2){\nif (ampm) { found_ampm=true; return "[]"; }\nif (fmin) { m=n.getMinutes(); return fmin + (m<10 ? "0" + m : m); }\nif (fmin2) { m=n.getMinutes(); return (m<10 ? "0" + m : m) + fmin2; }\nif (mmin) { return mmin + n.getMinutes(); }\nif (mmin2) { return n.getMinutes() + mmin2; }\nreturn "";\n});\n';g+='res.value=res.value.replace(/(ss)|(s)|(hh)|(h)|(dddd)|(ddd)|(dd)|(d)|(mmmmm)|(mmmm)|(mmm)|(mm)|(m)|(yyyy)|(yy)|(\\[])/gi,function(a,ss,s,hh,h,dddd,ddd,dd,d,mmmmm,mmmm,mmm,mm,m,yyyy,yy,ampm){\nif (ss) { m=n.getSeconds(); return m<10 ? "0" + m : m; }\nif (s) { return n.getSeconds(); }\nif (hh) { m=n.getHours(); if (found_ampm) m=m%12; return m<10 ? "0" + m : m; }\nif (h) { return n.getHours(); if (found_ampm) m=m%12; }\nif (hh) { m=n.getHours(); return m<10 ? "0" + m : m; }\nif (dddd) { return DataFormatter.locale.days[n.getDay()]; }\nif (ddd) { return DataFormatter.locale.days_short[n.getDay()]; }\nif (dd) { m=n.getDate(); return m<10 ? "0" + m : m; }\nif (d) { return n.getDate(); }\nif (mmmmm) return DataFormatter.locale.months_short[n.getMonth()][0];\nif (mmmm) return DataFormatter.locale.months[n.getMonth()];\nif (mmm) return DataFormatter.locale.months_short[n.getMonth()];\nif (mm) { m=n.getMonth()+1; return m<10 ? "0" + m : m; }\nif (m) { return n.getMonth()+1; }\nif (yyyy) return n.getFullYear();\nif (yy) return n.getFullYear().toString().substr(2);\nif (ampm) return n.getHours()<12 ? "AM" : "PM";\nreturn "";\n});\n'}g+="\n}}\n"}}}g+="res.value=DataFormatter.makeReplaces(res.value,repl);\n";g+="return res;\n";if(q){a+="if("+q+"){\n"+g+"}\n\n"}else{a+=g}}a+="return {value:n};\n";return(DataFormatter.functions[r]=Function("n,type",a))(m,c)},gcd:function(d,c){var e;while(c){e=d%c;d=c;c=e}return d}};